# 怡心阅读软件设计说明书

[TOC]

## 引言

### 编写目的

本软件设计说明书针对需求分析，描述了系统各个模块的设计。通过本文档，客户可以了解开发人员所设计的软件功能是否满足了客户需求，并对其中的细节与开发人员进行交流，便于及时反馈。本文档将作为开发人员在前期开发阶段的重要依据，以及后期交付阶段客户与开发团队共同检验软件是否符合需求的一个重要参考。

### 命名规范

采用驼峰命名法，变量名中每个单词的第一个字母小写，如 userName ，函数名同样遵循此规范；类名首字母大写。

### 参考资料

[1] 吕云翔，王昕鹏，邱玉龙. 软件工程——理论与实践. 北京：人民邮电出版社，2012.

[2] 吕云翔，刘浩，王昕鹏，周建. 软件工程课程设计. 北京：机械工业出版社，2009.

[3] 吕云翔编著. 软件工程实用教程. 北京：清华大学出版社，2015.

[4] “怡心阅读”需求规格说明书.

### 相关文档

“怡心阅读”需求规格说明书

## 总体设计

### 需求设定

本系统通过Web提供线上小说阅读平台，主要针对群体为小说爱好者。用户可以在本系统上注册成为读者，对平台的小说进行阅读。通过本平台，读者可以对众多小说进行筛选和排序，查看和发表自己的评论。系统管理员可以对图书进行上架、下架和信息修改。详细需求说明可参见《“怡心阅读”需求规格说明书》。

### 运行环境

#### 硬件运行环境

（1）服务器

处理器型号：n4系列 II

内存容量：1核2GB

网络配置：1 Mbps

（2）Web浏览PC机

处理器型号：AMD 或Intel 1.6 GHz以上

内存要求：256MB以上

网络配置：100M带宽网络适配器

#### 软件运行环境

（1）服务器

操作系统：Ubuntu 16.04或以上版本系统。

数据库：MySQL 5.0。

（2）客户机

操作系统：无限制

浏览器：支持所有主流浏览器。推荐使用Firefox 或者 Chrome等使用webkit内核的浏览器浏览本网站。

网络环境：客户机应能够访问互联网

#### 开发环境

本开发团队使用个人电脑作为开发机，软硬件配置如下：

##### 硬件环境

处理器型号：Intel® Core™ i7-7500U CPU @2.70Ghz 2.90Ghz

内存空间：8GB

硬盘容量：500GB

输入输出设备：鼠标、键盘、显示屏

网络配置：100M带宽网络适配器。

##### 软件环境

操作系统： Windows 10 64-bits

数据库：DataGrip 连接 MySQL

开发语言： Python，CSS，Razor(HTML) 等

开发框架： Django 3.2，Vue 3

软件运行环境： .NET 4.5，VC2012

集成开发环境：Pycharm 2021.4，Visual Studio Code 2021

测试工具： VisualStudio

版本控制工具： github

### 基本设计思想

根据系统的功能和定位，针对小说阅读平台应注意筛选小说的便捷，以及良好的阅读体验。在Web页面的结构设计中，系统应尽量能够在一个页面中完成一项功能。在Web页面的UI设计中，系统应采用统一的模板和布局，保证页面风格一致和整体布局的简洁清晰性。

### 子系统设计

| 编号 | 名称         | 功能描述                                                     |
| ---- | ------------ | ------------------------------------------------------------ |
| 1    | 用户子系统   | 1.     游客可以进行注册            2.     注册用户可以登录系统、查看和修改个人信息、修改个人信息和密码、上传头像、会员充值、登出系统 |
| 2    | 图书子系统   | 1.     用户可以对书库进行筛选、排序            2.     用户可以对书库进行搜索            3.     用户可以添加收藏 |
| 3    | 阅读器子系统 | 1.     用户可以选择小说和章节、对小说内容进行阅读            2.     用户可以对阅读界面进行设置和调整            3.     用户可以添加评论和笔记，并查看其它用户的评论            4.     用户可以添加和删除书签，并且可以在书签列表中通过书签跳转到对应位置 |
| 4    | 管理员子系统 | 1.     管理员可以对书进行上架、下架和信息修改                |

### 功能模块清单

#### 用户子系统

用户信息：账号(昵称)，密码，邮箱，头像，性别，地区，生日，个性签名

| 编号 | 名称         | 模块功能描述                           |
| ---- | ------------ | -------------------------------------- |
| 101  | 注册         | 需要账号，密码，邮箱                   |
| 102  | 登录         | 账号和密码，不支持邮箱                 |
| 103  | 修改密码     | 已经登录之后进行密码修改，直接修改即可 |
| 104  | 忘记密码     | 向用户邮箱中发送一则邮件验证码         |
| 105  | 查看个人信息 | 展示账号，密码和邮箱和是否是 `VIP`     |
| 106  | 登出         | 登出当前账号                           |
| 107  | `VIP` 开通   | 充钱                                   |
| 108  | 上传头像     | 传头像                                 |
| 109  | 修改个人信息 | 修改除邮箱和密码和账号以外的其他信息   |

![](./img/1-1.png)
![](./img/1-2.png)
![](./img/1-3.png)
![](./img/1-4.png)
![](./img/1-5.png)
![](./img/1-6.png)
![](./img/1-7.png)
![](./img/1-8.png)
![](./img/1-10.png)
![](./img/1-11.png)
![](./img/1-12.png)
![](./img/1-13.png)
![](./img/1-14.png)
![](./img/1-15.png)
![](./img/1-16.png)
![](./img/1-17.png)
![](./img/1-18.png)
![](./img/1-19.png)

#### 图书子系统

每本图书信息：书名，评分，字数，分类(标签)，作者，简介，状态信息(连载or完结)，封面图，目录，收藏数

| 编号 | 名称             | 模块功能描述                                 |
| ---- | ---------------- | -------------------------------------------- |
| 201  | 图书排名(评分)   | 根据图书的分类返回该分类下的评分较高的图书   |
| 202  | 图书排名(收藏数) | 根据图书的分类返回该分类下的收藏数较多的图书 |
| 203  | 图书搜索         | 根据书名搜索指定书籍                         |
| 204  | 图书评价(分类)   | 评价指定书籍的分数(评论可加可不加)           |
| 205  | 我的书架         | 返回当前用户收藏书籍                         |
| 206  | 收藏图书         | 当前用户收藏某本图书                         |
| 207  | 图书书签管理     | 返回当前用户所有书签                         |

![](./img/2-1.png)
![](./img/2-2.png)
![](./img/2-3.png)
![](./img/2-4.png)
![](./img/2-5.png)
![](./img/2-6.png)
![](./img/2-7.png)
![](./img/2-8.png)
![](./img/2-9.png)
![](./img/2-10.png)
![](./img/2-11.png)
![](./img/2-12.png)

#### 阅读器子系统

| 编号 | 名称          | 模块功能描述                                       |
| ---- | ------------- | -------------------------------------------------- |
| 301  | 阅读          | 某位用户阅读某本书籍的某一章内容                   |
| 302  | 添加评论      | 某位用户对某本书籍的某一章节进行评论，可以多次评论 |
| 303  | 添加笔记      | 笔记仅自己可见，功能与"添加评论"一致               |
| 304  | 删除评论/笔记 | 删除指定内容                                       |
| 305  | 查看目录      | 跳转到该本书其他章节                               |
| 306  | 页面设置      | 包含背景、颜色、字体大小、字体样式                 |
| 307  | 翻页          | 一章为一页，可以跳转到临近章节                     |
| 308  | 添加书签      | 为某书的某章添加书签                               |
| 309  | 删除书签      | 为某书的某章删除书签                               |


![](./img/3-1.png)
![](./img/3-2.png)
![](./img/3-3.png)
![](./img/3-4.png)
![](./img/3-5.png)
![](./img/3-6.png)
![](./img/3-7.png)
![](./img/3-8.png)
![](./img/3-9.png)
![](./img/3-10.png)
![](./img/3-11.png)
![](./img/3-12.png)
![](./img/3-13.png)
![](./img/3-14.png)
![](./img/3-15.png)
![](./img/3-16.png)
![](./img/3-17.png)
![](./img/3-18.png)

#### 管理员子系统

| 编号 | 名称         | 功能模块描述                 |
| ---- | ------------ | ---------------------------- |
| 401  | 上架图书     | 上架某一本图书               |
| 402  | 下架图书     | 下架某一本图书               |
| 403  | 修改图书信息 | 修改图书名称，标签等基本信息 |

![](./img/4-1.png)
![](./img/4-2.png)
![](./img/4-3.png)
![](./img/4-4.png)
![](./img/4-5.png)
![](./img/4-6.png)

## 接口设计

### 用户接口

在用户界面的设计上，我们使用绘制软件进行草图绘制，采用Vue3作为前端框架进行组件化界面设计，使用Vue CLI进行前端项目的构建。

### 外部接口

在数据存储方面，我们采用腾讯云的云端数据库，使用MySQL进行数据的储存与管理，后端使用Django框架与云数据库进行交互，并使用Django框架实现后端其他功能的开发，充分利用Python的简洁性。另外，我们还将在本地使用DataGrip连接到云数据库以便在本地对云数据库进行管理。

### 内部接口

在前后端交互方面，由于Vue2框架并没有提供原生的网络模块，故前端采用Axios网络模块与后端进行交互，由前端给出数据需求，并由后端制定标准并给出接口文档。在界面跳转方面，使用Vue Router进行前端路由管理，后端使用Django原生的路由管理模块。

## 数据库设计

### 数据库中表名列表

| 编号 | 表名          | 表功能说明                 |
| ---- | ------------- | -------------------------- |
| 1    | User          | 用户信息表                 |
| 2    | BookBasicInfo | 书籍基本信息               |
| 3    | BookContext   | 每一本书的每一个章节的信息 |
| 4    | Score         | 用户给书籍的评分信息       |
| 5    | Collections   | 用户收藏书籍的信息         |
| 6    | Comments      | 用户评论和笔记             |
| 7    | Bookmarks     | 书签信息                   |

### 数据库列表清单

User表：

| 序号 | 英文字段名 | 中文字段名  | 数据类型   | 是否允许为空 | 主键/外键 |
| ---- | ---------- | ----------- | ---------- | ------------ | --------- |
| 1    | userID     | 用户名      | CharField  | 否           | 主键      |
| 2    | passwd     | 密码        | CharField  | 否           |           |
| 3    | email      | 邮箱        | EmailField | 否           |           |
| 4    | img        | 头像        | ImageField | 是           |           |
| 5    | gender     | 性别        | CharField  | 是           |           |
| 6    | region     | 地区        | CharField  | 是           |           |
| 7    | motto      | 个性签名    | CharField  | 是           |           |
| 8    | birth      | 生日        | DateField  | 是           |           |
| 9    | VIPDate    | VIP到期日期 | DateField  | 是           |           |

BookBasicInfo表：

| 序号 | 英文字段名  | 中文字段名        | 数据类型     | 是否允许为空 | 主键/外键 |
| ---- | ----------- | ----------------- | ------------ | ------------ | --------- |
| 1    | bookID      | 书籍ID            | IntegerField | 否           | 主键      |
| 2    | name        | 书名              | CharField    | 否           |           |
| 3    | totScore    | 获得的总分        | DecimalField | 否           |           |
| 4    | rateNumber  | 参与评分人数      | IntegerField | 否           |           |
| 5    | author      | 作者              | CharField    | 是           |           |
| 6    | status      | 状态（连载/完结） | CharField    | 否           |           |
| 7    | onShelf     | 上架/下架的状态   | BooleanField | 否           |           |
| 8    | wordsCnt    | 字数              | IntegerField | 否           |           |
| 9    | category    | 分类              | CharField    | 否           |           |
| 10   | profile     | 简介              | CharField    | 否           |           |
| 11   | img         | 封面              | ImageField   | 否           |           |
| 12   | collections | 收藏数            | IntegerField | 否           |           |

BookContext表：

| 序号 | 英文字段名 | 中文字段名 | 数据类型     | 是否允许为空 | 主键/外键 |
| ---- | ---------- | ---------- | ------------ | ------------ | --------- |
| 1    | bookID     | 书籍ID     | IntegerField | 否           | 主键/外键 |
| 2    | chapter    | 章节       | IntegerField | 否           | 主键      |
| 3    | context    | 文本内容   | CharField    | 否           |           |

Score表：

| 序号 | 英文字段名 | 中文字段名 | 数据类型     | 是否允许为空 | 主键/外键  |
| ---- | ---------- | ---------- | ------------ | ------------ | ---------- |
| 1    | userID     | 用户ID     | CharField    | 否           | 主键，外键 |
| 2    | bookID     | 书籍ID     | IntegerField | 否           | 主键，外键 |
| 3    | score      | 评分       | DecimalField | 否           |            |

Collections表：

| 序号 | 英文字段名 | 中文字段名 | 数据类型     | 是否允许为空 | 主键/外键  |
| ---- | ---------- | ---------- | ------------ | ------------ | ---------- |
| 1    | userID     | 用户ID     | CharField    | 否           | 主键，外键 |
| 2    | bookID     | 书籍ID     | IntegerField | 否           | 主键，外键 |

Comments表：

| 序号 | 英文字段名 | 中文字段名                | 数据类型     | 是否允许为空 | 主键/外键 |
| ---- | ---------- | ------------------------- | ------------ | ------------ | --------- |
| 1    | ID         | 评论ID                    | IntegerField | 否           | 主键      |
| 2    | userID     | 用户ID                    | CharField    | 否           | 外键      |
| 3    | bookID     | 书籍ID                    | IntegerField | 否           | 外键      |
| 4    | chapter    | 章节                      | IntegerField | 否           |           |
| 5    | context    | 文本内容                  | CharField    | 否           |           |
| 6    | visible    | 评论（公开）/笔记（私有） | BooleanField | 否           |           |

Bookmark表：

| 序号 | 英文字段名 | 中文字段名 | 数据类型     | 是否允许为空 | 主键/外键  |
| ---- | ---------- | ---------- | ------------ | ------------ | ---------- |
| 1    | userID     | 用户ID     | CharField    | 否           | 主键，外键 |
| 2    | bookID     | 书籍ID     | IntegerField | 否           | 主键，外键 |
| 3    | chapter    | 章节       | IntegerField | 否           | 主键       |

### 数据库表之间的关系

![](./img/6.png)

## 典型系统子功能设计

## 功能模块设计

### 登录页

![](./img/5-1.png)

#### 挂载目录：/login

#### 包含功能模块： 登录表单，注册按钮，忘记密码按钮

#### 调用背景：用户尝试登录时的主页，若用户没有账号，可以点击注册进入注册页面，若用户忘记密码可以点击忘记密码以重置密码。

#### 页面参数：用户是否登录，已登录用户id

#### 页面组成：

背景图片。

登录表单。

侧边按钮。

### 注册页

![](./img/5-2.png)

#### 挂载目录：/register

#### 包含功能模块： 注册表单

#### 调用背景：用户注册时的主页，账号为唯一主键不允许重复，若账号重复会报错误提示用户。

#### 页面参数：该账户是否已注册。

#### 页面组成：

背景图片。

注册表单。

### 主页面

![](./img/5-3.png)

挂载目录：/

包含功能模块： 导航栏，登录，注册，查看小说主页面，搜索

调用背景：登录网页时的默认主页，当未登录用户试图查看小说主页面时，会跳转至登录界面，否则功能正常使用。

页面组成：

导航栏（顶部及左侧）。

搜索栏（顶部）。

小说展示区（右侧）。

侧边按钮。

### 个人中心界面

![](./img/5-4.png)

挂载目录：/user/info

包含功能模块： 个人信息展示，修改个人信息，退出登录。

页面参数：用户id

调用背景：在已经登录后可以点击导航栏右边的头像进入。

页面组成：

个人信息。

上传头像。

侧边按钮。

### 小说主界面

![](./img/5-5.png)

挂载目录：/novel/item

包含功能模块： 小说详细信息展示模块，用户对小说的操作模块。

页面参数：用户是否已经登录，用户id，小说id

调用背景：在已经登录的情况下点击主界面的小说可以进入小说主页面。

页面组成：

小说详细信息（顶部以及底部）。

导航栏（中间）。

用户操作模块。

### 阅读页

![](./img/5-6.png)

挂载目录：/novel/item/articleId

包含功能模块：导航栏，小说具体内容，切换章节。

页面参数：用户id，小说id，小说章节

调用背景：从小说主页面通过点击“开始阅读”或者目录中的章节或者自己的书签进入到指定章节进行阅读。

页面组成：

导航栏（左侧）。

小说具体内容（主体）。

切换章节功能（底部）。

## 角色授权设计

我们设计的怡心阅读平台一共有四类角色，这四类角色的权限见下表，数字的大小代表了角色在对应子系统中拥有的权限级别，权限级别越高，能使用的子系统功能就越多。

| 子系统       | 游客 | 普通用户 | VIP用户 | 管理员 |
| ------------ | ---- | -------- | ------- | ------ |
| 用户子系统   |      | 1        | 1       |        |
| 图书子系统   |      | 1        | 1       |        |
| 阅读器子系统 |      | 1        | 2       |        |
| 管理员子系统 |      |          |         | 1      |

## 系统出错处理设计

系统出错最严重的就是系统没有保证用户的用户名、密码、个人信息和资金的安全性。为了从根本上解决这个问题，首先在编写前台和后台代码时就要注意编写的严密性，不能让不怀好意的人利用保留的攻击手段侵入系统，盗用、毁坏用户的信息，造成用户的损失。

### 出错信息

用一览表的方式说明每一种可能出错的情况出现时，系统输出信息的形式、含义级处理的方法。

由于输入信息不符合规范（如：用户名、邮箱格式错误等），称之为软错误；

由于硬件方面的错误（如：网络传输超时、硬件出错等），称之为硬错误；

对于一些关键的操作（如：修改密码），提供提示确认机制；

对于数据，提供相应的保密措施设置。

出错信息如下：

- 数据库错误
  - 连接
    - 连接超时
    - 连接断开
  - 数据库本身
    - 数据库代码错误
    - 数据库溢出
- TCP连接错误
  - 连接
    - 连接超时
    - 连接断开
  - 其它TCP错误
    - Socket自身错误
- 系统部分自定义错误
  - 权限错误
    - 管理员权限设置故障
  - 输入错误
    - 用户ID错误/为空
	- 用户密码错误/为空
- 链接错误
  - 内部连接错误
    - 网页链接错误
    - 文件/图片链接错误
  - 外部链接错误

### 故障预防与补救

说明故障出现后可能采取的变通措施，主要包括：

- 对于软错误，需要在添加/修改操作中及时对输入数据进行验证，分析错误的类型，并且给出相应的错误提示语句，传送到客户端的浏览器上；对于硬错误，错误类型较少而且比较明确，所以可以在可能出错的地方中输出相应的出错语句，并将程序重置，最后返回输入阶段；
- 后备技术说明准备采用的后备技术，当原始数据丢失时启用的副本的建立和启动的技术，例如周期性的把磁盘信息记录在案；
- 恢复及在启动技术说明将使用的恢复再启动技术，是软件从故障点恢复执行或是软件从头开始重新开始运行的方法。

### 出错处理设计

#### 出错输出信息

- 数据库错误：无法访问到数据库，请联系系统管理员
- TCP连接错误：TCP链接错误，请检查您的网络链接
- 系统部分自定义错误
  - 权限错误：权限不足，请返回上一页面
  - 输入错误：输入格式错误，请检查输入信息
  - 查找错误：未查到符合要求的内容，请检查查找内容
- 链接错误：跳转至404 Not Found页面

#### 出错处理对策

对于因用户误操作而产生的错误，系统要做到及时提醒用户并纠正其错误；对于系统自身导致的出错，应告知用户及时联系管理员，并产生相应的错误日志以供之后维护。

## 系统维护与安全设计

### 系统维护设计

此项主要是对服务器上的数据库以及相关文件进行维护。

数据库维护：我们使用数据库的维护功能机制，比如，定期备份数据库，定期检测数据库的一致性，定期查看操作日志等；

文件方面：定期删除不再使用的数据文件。

为了保持本系统的优秀以及更好的发展，我们会设立反馈收集专区，为用户的体验反馈提供一个入口，我们通过收集这一专区内部的反馈信息，来对用户提出的问题以及改进建议进行落实，不断更新系统，保持系统的活力。

### 安全设计

对于数据库中存的敏感信息都进行加密处理，减小黑客攻击的危害。

前台程序的用户数量多，地点比较分散，应限制非法用户对本系统的使用。拟采用web服务器端对网站安全性的实现手段。对有异常行为的IP地址，我们将对其进行限制。且，我们要求注册用户均通过北航邮箱进行实名认证。

后台管理程序的使用权控制通过页面认证表单来实现。同时加上利用web服务器的安全认证来实现。另外计划通过在服务器、客服机中安装数字证书来提供额外的安全性。

## 测试计划

测试计划作为本系统的测试指导，测试成员按计划和规定进行测试。本系统的测试将从单元测试，集成测试，负载测试、以及后续的beta测试四个方面来设计。

目前的测试计划如下表所示：

| 序号 | 测试计划类型 | 对应部分         | 测试计划内容                       | 计划测试时间 | 目前是否完成 |
| ---- | ------------ | ---------------- | ---------------------------------- | ------------ | ------------ |
| 1    | 单元测试     | 注册登录模块     | 测试注册登录相关功能               | 2023.5.28    | 否           |
| 2    | 单元测试     | 个人信息修改模块 | 测试修改个人信息、修改头像相关功能 | 2023.5.28    | 否           |
| 3    | 单元测试     | 充值模块         | 测试充值VIP相关功能                | 2023.5.28    | 否           |
| 4    | 单元测试     | 书库模块         | 测试筛选排序功能的稳定性及搜索功能 | 2023.5.28    | 否           |
| 5    | 单元测试     | 阅读模块         | 测试阅读功能的体验                 | 2023.5.28    | 否           |
| 6    | 单元测试     | 书签模块         | 测试书签的添加、删除和跳转功能     | 2023.5.28    | 否           |
| 7    | 单元测试     | 收藏模块         | 测试收藏和查看书架功能             | 2023.5.28    | 否           |
| 8    | 单元测试     | 评论/笔记模块    | 测试评论和笔记的发表于查看功能     | 2023.5.28    | 否           |
| 9    | 单元测试     | 管理员木块       | 测试书籍管理功能                   | 2023.5.28    | 否           |
| 10   | 系统测试     | 整个怡心阅读平台 | 测试整个平台的运行是否正常         | 2023.5.29    | 否           |

